CPTC Notes:

------------------------------------------------------
Configurations:
  Metasploit.rc
  load auto_add_route
  setg ExitOnSession false
  load alias
  alias handler use exploit/multi/handler
  setg TimestampOutput true
  setg VERBOSE true
  alias del rm
-----------------------------------------------------
Intial Recon:
  - route -n
  - Wireshark to check for any traffic
  - Obtain hosts: nmap -sn 192.168.1.0/24
  - Find domain controllers: nmap -p 53 192.168.1.0/24 | grep "domain"
  - Zone transfer misconfig: dnsrecon
  - Brute force host names:
    for ip in $(seq 0 255); do host 192.168.1.$ip; done
  - theharvester -d cisco.com -b google>google.txt  -Check for emails
--------------------------------------------------------
Port scanning:
Inital port scan all ports on ip:
us -mT -Iv ip:a -r 3000 -R 3 && us -mU -Iv ip:a -r 3000 -R 3
2nd port scan intensive:
nmap -A -v -p- $ip
----------------------------------------------------------
Port 445/139 SMB/Netbios:
- enum4linux -A
- nmap scripts
- rpcclient: rpcclient -U rob 10.11.0.1
enumdomusers
- nbtscan: nbtscan -r
How to SMBclient:
/usr/bin/smbclient \\\\zimmerman\\public mypasswd
------------------------------------------------------------
Port 80/443 HTTP/HTTPS:
Brute Forcing Directories:
dirb
gobuster: gobuster -u http://10.11.1.71/  -w /usr/share/seclists/Discovery/Web_Content/common.txt  -s '200,204,301,302,307,403,500' -e 
CGI Brute force: /usr/share/seclists/Discovery/Web_Content/cgis.txt

burp suite...
nikto
nmap http scripts
------------------------------------------------------------
Port 161 SNMP:
onesixtyone
snmpwalk
-----------------------------------------------------------
Port 21 FTP:
- Check for misconfigurations (anonymous login)
- Nmap NTLM sript
After anonymous login maybe directory transversle
-----------------------------------------------------------
Port 23 Telnet:
- Check for misconfigurations
nmap NTLM script
------------------------------------------------------------
Port 3306/1433 MySQL/MS-SQL 
- MS SQL Use SQSH
- MySQL/MS SQL Check for anonymous
- MS SQL login check for XP_CMDSHELL:
EXEC xp_cmdshell 'dir';  
GO  

--------------------------------------------------------------
*******************New page********************************
----------------------------------------------------------------
PHP Obtaining Shell: https://github.com/ckt29175/oscp/blob/master/Notes/Getting-Shell-Related.txt
----------------------------------------------------------------
Directory transversele for windows (spaces):
ls ../../../Docume~1/
If want to directory transverse to: "Documents and Settings"
----------------------------------------------------------------
Compiling exploits:
https://github.com/ckt29175/oscp/blob/master/Notes/Compile.txt
If editting public exploits:
Try to use the same payload
Make sure size of payload is equal or LESS than the size of payload in exploit
If less, add NOPS "\x90"
----------------------------------------------------------------
Hydra Brute Forcing:
hydra -P /usr/share/wordlistsnmap.lst 192.168.X.XXX smtp -V
----------------------------------------------------------------
process.h, string.h, winbase.h, windows.h, winsock2.h - Windows exploit code
arpa/inet.h, fcntl.h, netdb.h, netinet/in.h, sys/sockt.h, sys/types.h, unistd.h - Linux exploit code
-----------------------------------------------------------------
TTY Shells:
Python TTY Shell Trick
python -c 'import pty;pty.spawn("/bin/bash")'
echo os.system('/bin/bash')

Spawn Interactive sh shell
/bin/sh -i

Spawn Perl TTY Shell
exec "/bin/sh";
perl â€”e 'exec "/bin/sh";'

Spawn Ruby TTY Shell
exec "/bin/sh"

Spawn Lua TTY Shell
os.execute('/bin/sh')

Spawn TTY Shell from Vi. Run shell commands from vi:
:!bash

Spawn TTY Shell NMAP
!sh
-------------------------------------------------------------------------
Passwords:
hashcat -m 1000 -a 0 /hash.txt /usr/share/wordlists/rockyou.txt  (-m is for NTLM hash cracking)
hash-identifier - Check the type of hash
cewl www.megacorpone.com -m 6 -w megacorp-cewl.txt  - Obtain words on megacorp.com with size 6 and up (Create password to brute force)
crunch - Create password list
--------------------------------------------------------------------------
